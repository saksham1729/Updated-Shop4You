{% extends 'app/base.html' %}
{% load static %}
{% block title %}Orders{% endblock title %}

{% block main-content %}
<div class="container my-5">
  <div class="row">
    <h3 class="text-body">Welcome {{ request.user.username|capfirst }} </h3>

    <!-- Sidebar -->
    <div class="col-sm-2 border-end text-body">
      <ul class="list-unstyled">
        <li class="d-grid">
          <a href="{% url 'orders' %}" class="btn btn-primary">Orders</a>
        </li>
      </ul>
    </div>

    <!-- Orders List -->
    <div class="col-sm-10">
      {% for op in order_placed %}
      <div class="card mb-3 p-3 shadow-sm bg-body text-body border-0">
        <div class="row align-items-center">
          <div class="col-md-2 text-center">
            <img src="{{ op.product.product_image.url }}" alt="Product Image" class="img-fluid" style="max-height: 100px;">
          </div>
          <div class="col-md-6">
            <p class="mb-1"><strong>Product:</strong> {{ op.product.title }}</p>
            <p class="mb-1"><strong>Quantity:</strong> {{ op.quantity }}</p>
            <p class="mb-1"><strong>Price:</strong> â‚¹{{ op.total_cost }}</p>
            <a href="{% url 'track-order' op.id %}" class="btn btn-outline-primary">Track Order</a>
          </div>
          <div class="col-md-4">
            <p class="fw-bold">Order Status: {{ op.status }}</p>

            {% if op.status == 'Accepted' %}
              <div class="progress"><div class="progress-bar" role="progressbar" style="width: 20%;"></div></div>
            {% elif op.status == 'Packed' %}
              <div class="progress"><div class="progress-bar bg-info" role="progressbar" style="width: 40%;"></div></div>
            {% elif op.status == 'On The Way' %}
              <div class="progress"><div class="progress-bar bg-warning" role="progressbar" style="width: 70%;"></div></div>
            {% elif op.status == 'Delivered' %}
              <div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%;"></div></div>
            {% endif %}
          </div>
        </div>
      </div>
      {% empty %}
        <p class="text-secondary">You haven't placed any orders yet.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock main-content %}
